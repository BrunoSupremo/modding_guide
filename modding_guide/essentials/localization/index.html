<html>
   <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link href='/modding_guide/css/styles.css' rel='stylesheet' type='text/css'>
      <link rel="icon" type="image/png" href='/modding_guide/images/favicon_logo_sh.png'>
      <link rel="apple-touch-icon" type="image/png" href='/modding_guide/images/favicon_logo_sh.png'>
      <link rel="icon" type="image/png" sizes="144x144" href='/modding_guide/images/favicon_logo_sh.png'>
      <title>Localization</title>
   </head>
   <body>
      <script src="/modding_guide/menus.js"></script>
      <main>
         <h1>Localization</h1>
         <p>
         <h2><a name="Localization"></a>About localization</h2>
         </p>
         <p>Stonehearth's UI is encoded in UTF-8 and we use this Javascript <a href="https://www.i18next.com/">framework</a> for localization.</p>
         <p>In order to enable localization for your mod, you need to add this key to your manifest. Usually we put it below the "info" section to avoid forgetting about it (remember to add commas where needed!) :</p>
         <pre><code>  "default_locale" : "en"
</code></pre>
         <p>Localization in the game works this way: for every text that we want to be translatable, we create a key in the <code>stonehearth/locales/en.json</code> file. Then, in our JSON files, we reference that key wrapping it with <strong>"i18n()"</strong>.
            For example, this is how we specify the name and description of the brightbell window box:
         </p>
         <pre><code>  "entity_data": {
     "stonehearth:catalog": {
        "display_name": "i18n(stonehearth:entities.decoration.window_box_brightbell.window_box_brightbell_ghost.display_name)",
        "description": "i18n(stonehearth:entities.decoration.window_box_brightbell.window_box_brightbell_ghost.description)",
        "icon": "file(window_box_brightbell.png)",
        "category": "decoration",
        "material_tags": "decoration crafted stockpile_decoration"
     }
  }
</code></pre>
         <p>Notice the dots separating the keys. In the en.json file, we'll have this structure:</p>
         <pre><code>  {
     "entities" : {
        "decoration": {
           "window_box_brightbell" : {
              "window_box_brightbell_ghost" : {
                 "display_name" : "Brightbell planter",
                 "description" : "A tidy home for the plant."
              }
           }
        }
     }
  }
</code></pre>
         <p>So we use "i18n()" and inside it we write the namespace of our mod, a colon, and then the hierarchy of keys that we set up in the language file, separated by dots. When the game loads this file, it will replace the i18n() string with the actual translation we specified in our language file.</p>
         <p>For quick testing, we can write plain text instead of "i18n(...)" and the game should be able to read it fine. But later we'll have to change it as explained above to make it translatable.</p>
         <p>We have thousands of text lines to translate in the stonehearth mod, so we organize the keys imitating our folder structure. In this case, the text we want to translate is inside <code>stonehearth/entities/decoration/window_box_brightbell/window_box_brightbell_ghost.json</code>.</p>
         <p>When adding localization to your own mod, you can use any nodes you like for your en.json file, you can even have all the keys at the same level, like this:</p>
         <pre><code>  {
     "name_1" : "Test",
     "description_1" : "My description",
     "info" : "Another text"
  }
</code></pre>
         <p>But it's useful to have them organized so that you can have repeated keys inside different nodes.</p>
         <p>When making a translation mod for an existing en.json file, you have to use the exact same keys, then translate the text/value part into your language.</p>
         <p><img src="/modding_guide/images/common/row_alert2.png" alt="icon"/> When translating the stonehearth mod, you might find special text inside localization strings, such as <strong>[str(i18n_data.town_name)]</strong>. These are meant to be left untouched. They are variables that will get substituted inside the game. For example, [str(i18n_data.town_name)] represents your town name. These variables are declared in JSON files such as campaign encounters that trigger dialogs. That way, we can use proper nouns dynamically generated by the game inside of our translatable text, such as boss names, your town name (which you customize when you start playing), etc.</p>
         <p>Information about fonts and how to make translation mods can be found <a href="../../basic/localization_mod/index.html">here</a>.</p>
      </main>
   </body>
</html>